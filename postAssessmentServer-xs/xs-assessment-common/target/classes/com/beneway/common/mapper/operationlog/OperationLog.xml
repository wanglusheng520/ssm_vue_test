<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.beneway.common.dao.operationlog.OperationLogDao">

    <resultMap id="res" type="com.beneway.common.entity.operationlog.OperationLog"></resultMap>

    <select id="newAssesEvent" resultMap="res">
        SELECT
            ass_id,
            ass_type,
            create_time,
            stage
        FROM
            operation_log
        WHERE
            ass_id IN ( SELECT DISTINCT ass_id FROM ass_user WHERE unit_id = #{supUnitId} )
        GROUP BY
            ass_id,
            stage
        ORDER BY
            create_time DESC
            LIMIT 10
    </select>

    <select id="assessAmount" resultType="integer">
        select count(*) from (select DISTINCT ass_id from operation_log) as a
    </select>
    <select id="yiAssess" resultType="integer">
        select count(*) from (select DISTINCT ass_id from operation_log where (stage = #{stage} or stage = #{stage1} or stage = #{stage2})) as a
    </select>
    <select id="yizg" resultType="integer">
        select count(*) from (select DISTINCT ass_id from operation_log where stage = #{stage}) as a
    </select>
</mapper>